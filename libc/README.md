Copy from https://gitlab.com/cznic/libc with the memory allocation section Modified

